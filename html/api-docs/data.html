

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>data &mdash; OpenSeq2Seq 0.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="image2label" href="data.image2label.html" />
    <link rel="prev" title="models" href="models.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> OpenSeq2Seq
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine-translation.html">Machine Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech-recognition.html">Speech Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech-synthesis.html">Speech Synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distr-training.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed-precision.html">Mixed precision training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../in-depth-tutorials.html">In-depth tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive-infer-demos.html">Interactive Infer Mode</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="models.html">models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.image2label.html">image2label</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.speech2text.html">speech2text</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.text2text.html">text2text</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.text2speech.html">text2speech</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-data.data_layer">data_layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-data.utils">utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="encoders.html">encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="decoders.html">decoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="losses.html">losses</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimizers.html">optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="parts.html">parts</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenSeq2Seq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">API documentation</a> &raquo;</li>
        
      <li>data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api-docs/data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-data">
<span id="data"></span><h1>data<a class="headerlink" href="#module-data" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="data.image2label.html">image2label</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.image2label.html#id1">image2label</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.image2label.html#module-data.image2label.imagenet_preprocessing">imagenet_preprocessing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.speech2text.html">speech2text</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.speech2text.html#id1">speech2text</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.speech2text.html#module-data.speech2text.speech_utils">speech_utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.text2text.html">text2text</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.text2text.html#module-data.text2text.t2t">t2t</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.text2text.html#id1">text2text</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.text2text.html#module-data.text2text.tokenizer">tokenizer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.text2speech.html">text2speech</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.text2speech.html#id1">text2speech</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.text2speech.html#module-data.text2speech.speech_utils">speech_utils</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-data.data_layer">
<span id="data-layer"></span><h2>data_layer<a class="headerlink" href="#module-data.data_layer" title="Permalink to this headline">¶</a></h2>
<p>Data layer classes</p>
<dl class="class">
<dt id="data.data_layer.DataLayer">
<em class="property">class </em><code class="descclassname">data.data_layer.</code><code class="descname">DataLayer</code><span class="sig-paren">(</span><em>params</em>, <em>model</em>, <em>num_workers</em>, <em>worker_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract class from which all data layers must inherit.</p>
<dl class="method">
<dt id="data.data_layer.DataLayer.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>params</em>, <em>model</em>, <em>num_workers</em>, <em>worker_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Data layer constructor.
The TensorFlow graph should not be created here, but rather in the
<a class="reference internal" href="#data.data_layer.DataLayer.build_graph" title="data.data_layer.DataLayer.build_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">self.build_graph()</span></code></a> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>params</strong> (<em>dict</em>) – parameters describing the data layer.
All supported parameters are listed in <a class="reference internal" href="#data.data_layer.DataLayer.get_required_params" title="data.data_layer.DataLayer.get_required_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_required_params()</span></code></a>,
<a class="reference internal" href="#data.data_layer.DataLayer.get_optional_params" title="data.data_layer.DataLayer.get_optional_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_optional_params()</span></code></a> functions.</li>
<li><strong>model</strong> (instance of a class derived from <a class="reference internal" href="models.html#models.model.Model" title="models.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – parent model that created this data layer.
Could be None if no model access is required for the use case.</li>
<li><strong>num_workers</strong> (<em>int</em>) – number of Horovod processes or number of GPUs
if Horovod is not used.</li>
<li><strong>worker_id</strong> (<em>int</em>) – Horovod process id or GPU id if Horovod is not used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Config parameters:</p>
<ul class="simple">
<li><strong>shuffle</strong> (bool) — whether to shuffle dataset after an epoch.
Typically will be True for train and False for inference and evaluation.</li>
<li><strong>dtype</strong> — data dtype. Could be either <code class="docutils literal notranslate"><span class="pre">tf.float16</span></code> or <code class="docutils literal notranslate"><span class="pre">tf.float32</span></code>.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="data.data_layer.DataLayer.build_graph">
<code class="descname">build_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer.build_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer.build_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Here all TensorFlow graph construction should happen.</p>
</dd></dl>

<dl class="method">
<dt id="data.data_layer.DataLayer.create_feed_dict">
<code class="descname">create_feed_dict</code><span class="sig-paren">(</span><em>model_in</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer.create_feed_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer.create_feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>A function that must be defined for data layers that support interactive
infer. Given input which is an abstract data element to be defined by the
data layer. The intended use is for the user to build and pass model_in from
the jupyter notebook. Given model_in, the data layer must preprocess the raw
data, and create the feed dict that defines the placeholders defined in
create_interactive_placeholders().</p>
</dd></dl>

<dl class="method">
<dt id="data.data_layer.DataLayer.create_interactive_placeholders">
<code class="descname">create_interactive_placeholders</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer.create_interactive_placeholders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer.create_interactive_placeholders" title="Permalink to this definition">¶</a></dt>
<dd><p>A function that must be defined for data layers that support interactive
infer. This function is intended to create placeholders that will be passed
to self._input_tensors that will be passed to the model.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="data.data_layer.DataLayer.get_optional_params">
<em class="property">static </em><code class="descname">get_optional_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer.get_optional_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer.get_optional_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method with description of optional parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary containing all the parameters that <strong>can</strong> be
included into the <code class="docutils literal notranslate"><span class="pre">params</span></code> parameter of the
class <a class="reference internal" href="#data.data_layer.DataLayer.__init__" title="data.data_layer.DataLayer.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> method.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="data.data_layer.DataLayer.get_required_params">
<em class="property">static </em><code class="descname">get_required_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer.get_required_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer.get_required_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method with description of required parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary containing all the parameters that <strong>have to</strong> be
included into the <code class="docutils literal notranslate"><span class="pre">params</span></code> parameter of the
class <a class="reference internal" href="#data.data_layer.DataLayer.__init__" title="data.data_layer.DataLayer.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> method.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="data.data_layer.DataLayer.get_size_in_samples">
<code class="descname">get_size_in_samples</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/data_layer.html#DataLayer.get_size_in_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_layer.DataLayer.get_size_in_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Should return the dataset size in samples.
That is, the number of objects in the dataset. This method is used to
calculate a valid epoch size. If this method is not defined, you will need
to make sure that your dataset for evaluation is created only for
one epoch. You will also not be able to use <code class="docutils literal notranslate"><span class="pre">num_epochs</span></code> parameter in the
base config.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dataset size in samples.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="data.data_layer.DataLayer.input_tensors">
<code class="descname">input_tensors</code><a class="headerlink" href="#data.data_layer.DataLayer.input_tensors" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary containing input tensors.
This dictionary has to define the following keys: <cite>source_tensors</cite>,
which should contain all tensors describing the input object (i.e. tensors
that are passed to the encoder, e.g. input sequence and input length). And
when <code class="docutils literal notranslate"><span class="pre">self.params['mode']</span> <span class="pre">!=</span> <span class="pre">&quot;infer&quot;</span></code> data layer should also define
<cite>target_tensors</cite> which is the list of all tensors related to the
corresponding target object (i.e. tensors taht are passed to the decoder and
loss, e.g. target sequence and target length). Note that all tensors have
to be created inside <a class="reference internal" href="#data.data_layer.DataLayer.build_graph" title="data.data_layer.DataLayer.build_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">self.build_graph()</span></code></a> method.</p>
</dd></dl>

<dl class="attribute">
<dt id="data.data_layer.DataLayer.iterator">
<code class="descname">iterator</code><a class="headerlink" href="#data.data_layer.DataLayer.iterator" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">tf.data.Dataset</span></code> iterator.
Should be created by <a class="reference internal" href="#data.data_layer.DataLayer.build_graph" title="data.data_layer.DataLayer.build_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">self.build_graph()</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="data.data_layer.DataLayer.params">
<code class="descname">params</code><a class="headerlink" href="#data.data_layer.DataLayer.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters used to construct the data layer (dictionary).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-data.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-data.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="data.utils.load_pre_existing_vocabulary">
<code class="descclassname">data.utils.</code><code class="descname">load_pre_existing_vocabulary</code><span class="sig-paren">(</span><em>path</em>, <em>min_idx=0</em>, <em>read_chars=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/utils.html#load_pre_existing_vocabulary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.utils.load_pre_existing_vocabulary" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads pre-existing vocabulary into memory.</p>
<p>The vocabulary file should contain a token on each line with optional
token count on the same line that will be ignored. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="mi">1234</span>
<span class="n">b</span> <span class="mi">4321</span>
<span class="n">c</span> <span class="mi">32342</span>
<span class="n">d</span>
<span class="n">e</span>
<span class="n">word</span> <span class="mi">234</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em>) – path to vocabulary.</li>
<li><strong>min_idx</strong> (<em>int</em><em>, </em><em>optional</em>) – minimum id to assign for a token.</li>
<li><strong>read_chars</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to read only the
first symbol of the line.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">vocabulary dictionary mapping tokens (chars/words) to int ids.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data.utils.pad_vocab_to_eight">
<code class="descclassname">data.utils.</code><code class="descname">pad_vocab_to_eight</code><span class="sig-paren">(</span><em>vocab</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/data/utils.html#pad_vocab_to_eight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.utils.pad_vocab_to_eight" title="Permalink to this definition">¶</a></dt>
<dd><p>Pads vocabulary so that it is divisible by 8.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vocab</strong> (<em>dict</em>) – vocabulary in the form token-&gt;id</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">vocab with new tokens added if necessary, such that the total
vocab size is divisible by 8.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data.image2label.html" class="btn btn-neutral float-right" title="image2label" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="models.html" class="btn btn-neutral" title="models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, NVIDIA.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script>  
  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #64d81c;
    }
    .wy-side-nav-search > div.version {
      color: #ffffff;
    }
    .wy-side-nav-search > img {
      max-width: 150px;
    }
    .wy-side-nav-search > a {
      font-size: 23px;
    }
  </style>


</body>
</html>